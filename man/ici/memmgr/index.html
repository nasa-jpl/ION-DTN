<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://nasa-jpl.github.io/ION-DTN/man/ici/memmgr/" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>NAME - ION-DTN Open Source Documentation</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "NAME";
        var mkdocs_page_input_path = "man/ici/memmgr.md";
        var mkdocs_page_url = "/ION-DTN/man/ici/memmgr/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> ION-DTN Open Source Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">ION Overview</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../ION-Quick-Start-Guide/">Quick Start</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../ION-Deployment-Guide/">ION Deployment Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../ION-Guide/">ION Design & Operation Manual</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../ION-Watch-Characters/">Watch Characters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../AMS-Programmer-Guide/">AMS Programmer's Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Use-Cases/">Use Cases</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../List-of-Papers/">Publications/Papers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../community/Contributing-Code-to-ION/">Contribute Code</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Configuration</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Basic-Configuration-File-Tutorial/">Basic Configuration Tutorial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../ION-Config-File-Templates/">Configuration Templates</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Configure-Multiple-Network-Interfaces/">Multi-network Configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Using-LTP-Config-Tool/">LTP Configuration Tool</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Man Pages</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../ams/">Asychronous Messaging System (AMS)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../bpv6/">Bundle Protocol v6 (BPv6)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../bpv7/">Bundle Protcool v7 (BPv7)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../bss/">Bundle Streaming Service (BSS)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../bssp/">Bundle Streaming Service (Test Utility) Protocol (BSSP)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cfdp/">CCSDS File Delivery Protocol (CFDP)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../dgr/">Datagram Retransmission System (DGR)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../">Interplanetary Communications Infrastructure (ICI)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ltp/">Licklider Transmission Protocol (LTP)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../nm/">Network Management Agent for Asynchronous Management Protocol (AMP)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../restart/ionrestart/">ION Node Restart Utility</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tc/">Delay Tolerant Key Administration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Cloud Deployment</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../community/dtn-gcp-main/ION-One-Node-on-Cloud-Linux-VM/">Running 1 ION Node on Cloud VM</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../community/dtn-gcp-2nodes/ION-Two-Node-on-Cloud-Linux-VMs/">Running 2 ION Node on Cloud VM</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../community/dtn-gcp-iot-main/ION-and-IOT-on-Linux-VMs-running-on-Cloud-Computing/">ION and IOT</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../community/dtn-gcp-ltp-tcp-main/ION-LTP-TCP-on-Azure/">LTP and TCP on Azure</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../community/dtn-multicasting-main/Multicasting-over-ION/">Multicast</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../community/dtn-video-intelligence-main/Video-Intelligence/">Video Intelligence</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">ION-DTN Open Source Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">NAME</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="name">NAME</h1>
<p>memmgr - memory manager abstraction functions</p>
<h1 id="synopsis">SYNOPSIS</h1>
<div class="highlight"><pre><span></span><code>#include &quot;memmgr.h&quot;

typedef void *(* MemAllocator)
    (char *fileName, int lineNbr, size_t size);
typedef void (* MemDeallocator)
    (char *fileName, int lineNbr, void * blk);
typedef void *(* MemAtoPConverter) (unsigned int address);
typedef unsigned int (* MemPtoAConverter) (void * pointer);

unsigned int memmgr_add       (char *name,
                               MemAllocator take, 
                               MemDeallocator release, 
                               MemAtoPConverter AtoP, 
                               MemPtoAConverter PtoA);
int memmgr_find               (char *name);
char *memmgr_name             (int mgrId);
MemAllocator memmgr_take      (int mgrId);
MemDeallocator memmgr_release (int mgrId);
MemAtoPConverter memmgr_AtoP  (int mgrId);
MemPtoAConverter memmgr_PtoA  (int mgrId;

int memmgr_open               (int memKey,
                               unsigned long memSize,
                               char **memPtr,
                               int *smId,
                               char *partitionName,
                               PsmPartition *partition,
                               int *memMgr,
                               MemAllocator afn,
                               MemDeallocator ffn,
                               MemAtoPConverter apfn,
                               MemPtoAConverter pafn);
void memmgr_destroy           (int smId,
                               PsmPartition *partition);
</code></pre></div>
<h1 id="description">DESCRIPTION</h1>
<p>"memmgr" is an abstraction layer for administration of memory
management.  It enables multiple memory managers to coexist
in a single application.  Each memory manager specification is required to
include pointers to a memory allocation function, a memory deallocation
function, and functions for translating between local memory pointers
and "addresses", which are abstract memory locations that have private
meaning to the manager.  The allocation function
is expected to return a block of memory of size "size" (in
bytes), initialized to all binary zeroes.  The <em>fileName</em> and <em>lineNbr</em>
arguments to the allocation and deallocation functions are expected to
be the values of __FILE__ and __LINE__ at the point at which the functions
are called; this supports any memory usage tracing via sptrace(3) that
may be implemented by the underlying memory management system.</p>
<p>Memory managers are identified by number and by name.  The identifying
number for a memory manager is an index into a private, fixed-length
array of up to 8 memory manager configuration structures; that is,
memory manager number must be in the range 0-7.  However, memory
manager numbers are assigned dynamically and not always predictably.
To enable multiple applications to use the same memory manager for
a given segment of shared memory, a memory manager may be located by
a predefined name of up to 15 characters that is known to all the applications.</p>
<p>The memory manager with manager number 0 is always available; its
name is "std".  Its memory allocation function is calloc(), its
deallocation function is free(), and its pointer/address translation
functions are merely casts.</p>
<ul>
<li>
<p>unsigned int memmgr_add(char *name,
                              MemAllocator take, 
                              MemDeallocator release, 
                              MemAtoPConverter AtoP, 
                              MemPtoAConverter PtoA)</p>
<p>Add a memory manager to the memory manager array, if not already defined;
attempting to add a previously added memory manager is not considered an
error.  <em>name</em> is the name of the memory manager.
<em>take</em> is a pointer to the manager's memory allocation
function; <em>release</em> is a pointer to the manager's
memory deallocation function.  <em>AtoP</em> is a pointer to
the manager's function for converting an address 
to a local memory pointer; <em>PtoA</em> is a pointer to
the manager's pointer-to-address converter function.
Returns the memory manager ID number assigned to the named manager,
or -1 on any error.</p>
<p><em>NOTE</em>: memmgr_add() is NOT thread-safe.  In a multithreaded execution
image (e.g., VxWorks), all memory managers should be loaded <em>before</em>
any subordinate threads or tasks are spawned.</p>
</li>
<li>
<p>int memmgr_find(char *name)</p>
<p>Return the memmgr ID of the named manager, or -1 if not found.</p>
</li>
<li>
<p>char *memmgr_name(int mgrId)</p>
<p>Return the name of the manager given by <em>mgrId</em>.</p>
</li>
<li>
<p>MemAllocator memmgr_take(int mgrId)</p>
<p>Return the allocator function pointer for the manager given by <em>mgrId</em>.</p>
</li>
<li>
<p>memDeallocator memmgr_release(int mgrId)</p>
<p>Return the deallocator function pointer for the manager given by <em>mgrId</em>.</p>
</li>
<li>
<p>MemAtoPConverter memmgr_AtoP(int mgrId)</p>
<p>Return the address-to-pointer converter function
pointer for the manager given by <em>mgrId</em>.</p>
</li>
<li>
<p>MemPtoAConverter memmgr_PtoA(int mgrId)</p>
<p>Return the pointer-to-address converter function
pointer for the manager given by <em>mgrId</em>.</p>
</li>
<li>
<p>int memmgr_open(int memKey,
                      unsigned long memSize,
                      char **memPtr,
                      int *smId,
                      char *partitionName,
                      PsmPartition *partition,
                      int *memMgr,
                      MemAllocator afn,
                      MemDeallocator ffn,
                      MemAtoPConverter apfn,
                      MemPtoAConverter pafn);</p>
<p>memmgr_open() opens one avenue of access to a PSM managed region of shared
memory, initializing as necessary.</p>
<p>In order for multiple tasks to share access to this memory region, all must
cite the same <em>memkey</em> and <em>partitionName</em> when they call memmgr_open().  If
shared access is not necessary, then <em>memKey</em> can be SM_NO_KEY and
<em>partitionName</em> can be any valid partition name.</p>
<p>If it is known that a prior invocation of memmgr_open() has already
initialized the region, then <em>memSize</em> can be zero and <em>memPtr</em>
must be NULL.  Otherwise <em>memSize</em> is required and the required value
of <em>memPtr</em> depends on whether or not the memory that is to be shared
and managed has already been allocated (e.g., it's a fixed region of bus
memory).  If so, then the memory pointer variable that <em>memPtr</em> points
to must contain the address of that memory region.  Otherwise, <em>*memPtr</em>
must contain NULL.</p>
<p>memmgr_open() will allocate system memory as necessary and will in
any case return the address of the shared memory region in <em>*memPtr</em>.</p>
<p>If the shared memory is newly allocated or otherwise not yet under
PSM management, then memmgr_open() will invoke psm_manage() to manage
the shared memory region.  It will also add a catalogue for the managed
shared memory region as necessary.</p>
<p>If <em>memMgr</em> is non-NULL, then memmgr_open() will additionally call
memmgr_add() to establish a new memory manager for this managed shared
memory region, as necessary.  The index of the applicable memory manager
will be returned in <em>memMgr</em>.  If that memory manager is newly created,
then the supplied <em>afn</em>, <em>ffn</em>, <em>apfn</em>, and <em>pafn</em> functions (which
can be written with reference to the memory manager index value returned
in <em>memMgr</em>) have been established as the memory management functions
for local private access to this managed shared memory region.</p>
<p>Returns 0 on success, -1 on any error.</p>
</li>
<li>
<p>void memmgr_destroy(int smId, PsmPartition *partition);</p>
<p>memmgr_destroy() terminates all access to a PSM managed region of shared
memory, invoking psm_erase() to destroy the partition and sm_ShmDestroy()
to destroy the shared memory object.</p>
</li>
</ul>
<h1 id="example">EXAMPLE</h1>
<div class="highlight"><pre><span></span><code>/* this example uses the calloc/free memory manager, which is
 * called &quot;std&quot;, and is always defined in memmgr. */

 #include &quot;memmgr.h&quot;

 main() 
 {
     int mgrId;
     MemAllocator myalloc;
     MemDeallocator myfree;
     char *newBlock;

     mgrId = memmgr_find(&quot;std&quot;);
     myalloc = memmgr_take(mgrId);
     myfree = memmgr_release(mgrId);
     ...

     newBlock = myalloc(5000);
     ...
     myfree(newBlock);
 }
</code></pre></div>
<h1 id="see-also">SEE ALSO</h1>
<p>psm(3)</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright (c) 2002-2011, California Institute of Technology. All rights reserved.</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
